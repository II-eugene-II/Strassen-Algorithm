
만약 M을 다음과 같이 정의하면 어떨까?

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{1}&space;:=&space;(a_{1}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{2}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{3}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{4}&space;\mathbf{A}_{2,2})&space;(&space;a_{5}\mathbf{B}_{1,1}&space;&plus;&space;a_{6}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{7}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{8}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{1} := (a_{1} \mathbf{A}_{1,1} + a_{2} \mathbf{A}_{1,2} + a_{3} \mathbf{A}_{2,1} + a_{4} \mathbf{A}_{2,2}) ( a_{5}\mathbf{B}_{1,1} + a_{6} \mathbf{B}_{1,2} + a_{7} \mathbf{B}_{2,1} + a_{8} \mathbf{B}_{2,2})" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{2}&space;:=&space;(a_{9}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{10}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{11}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{12}&space;\mathbf{A}_{2,2})&space;(&space;a_{13}\mathbf{B}_{1,1}&space;&plus;&space;a_{14}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{15}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{16}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{2} := (a_{9} \mathbf{A}_{1,1} + a_{10} \mathbf{A}_{1,2} + a_{11} \mathbf{A}_{2,1} + a_{12} \mathbf{A}_{2,2}) ( a_{13}\mathbf{B}_{1,1} + a_{14} \mathbf{B}_{1,2} + a_{15} \mathbf{B}_{2,1} + a_{16} \mathbf{B}_{2,2})" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{3}&space;:=&space;(a_{17}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{18}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{19}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{20}&space;\mathbf{A}_{2,2})&space;(&space;a_{21}\mathbf{B}_{1,1}&space;&plus;&space;a_{22}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{23}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{24}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{3} := (a_{17} \mathbf{A}_{1,1} + a_{18} \mathbf{A}_{1,2} + a_{19} \mathbf{A}_{2,1} + a_{20} \mathbf{A}_{2,2}) ( a_{21}\mathbf{B}_{1,1} + a_{22} \mathbf{B}_{1,2} + a_{23} \mathbf{B}_{2,1} + a_{24} \mathbf{B}_{2,2})" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{4}&space;:=&space;(a_{25}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{26}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{27}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{28}&space;\mathbf{A}_{2,2})&space;(&space;a_{29}\mathbf{B}_{1,1}&space;&plus;&space;a_{30}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{31}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{32}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{4} := (a_{25} \mathbf{A}_{1,1} + a_{26} \mathbf{A}_{1,2} + a_{27} \mathbf{A}_{2,1} + a_{28} \mathbf{A}_{2,2}) ( a_{29}\mathbf{B}_{1,1} + a_{30} \mathbf{B}_{1,2} + a_{31} \mathbf{B}_{2,1} + a_{32} \mathbf{B}_{2,2})" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{5}&space;:=&space;(a_{33}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{34}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{35}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{36}&space;\mathbf{A}_{2,2})&space;(&space;a_{37}\mathbf{B}_{1,1}&space;&plus;&space;a_{38}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{39}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{40}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{5} := (a_{33} \mathbf{A}_{1,1} + a_{34} \mathbf{A}_{1,2} + a_{35} \mathbf{A}_{2,1} + a_{36} \mathbf{A}_{2,2}) ( a_{37}\mathbf{B}_{1,1} + a_{38} \mathbf{B}_{1,2} + a_{39} \mathbf{B}_{2,1} + a_{40} \mathbf{B}_{2,2})" />

(단, <img src="https://latex.codecogs.com/svg.image?a_n&space;\left&space;(&space;a_n&space;-&space;1&space;\right&space;)&space;\left&space;(&space;a_n&space;&plus;&space;1&space;\right&space;)=0" title="https://latex.codecogs.com/svg.image?a_n \left ( a_n - 1 \right ) \left ( a_n + 1 \right )=0" /> 이다.)

이떄,

<img src="https://latex.codecogs.com/svg.image?\mathbf{C}_{1,1}&space;=&space;b_{1}&space;\mathbf{M}_{1}&space;&plus;&space;b_{2}&space;\mathbf{M}_{2}&space;&plus;&space;b_{3}&space;\mathbf{M}_{3}&space;&plus;&space;b_{4}&space;\mathbf{M}_{4}&space;&plus;&space;b_{5}&space;\mathbf{M}_{5}" title="https://latex.codecogs.com/svg.image?\mathbf{C}_{1,1} = b_{1} \mathbf{M}_{1} + b_{2} \mathbf{M}_{2} + b_{3} \mathbf{M}_{3} + b_{4} \mathbf{M}_{4} + b_{5} \mathbf{M}_{5}" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{C}_{1,2}&space;=&space;b_{6}&space;\mathbf{M}_{1}&space;&plus;&space;b_{7}&space;\mathbf{M}_{2}&space;&plus;&space;b_{8}&space;\mathbf{M}_{3}&space;&plus;&space;b_{9}&space;\mathbf{M}_{4}&space;&plus;&space;b_{10}&space;\mathbf{M}_{5}" title="https://latex.codecogs.com/svg.image?\mathbf{C}_{1,2} = b_{6} \mathbf{M}_{1} + b_{7} \mathbf{M}_{2} + b_{8} \mathbf{M}_{3} + b_{9} \mathbf{M}_{4} + b_{10} \mathbf{M}_{5}" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{C}_{2,1}&space;=&space;b_{11}&space;\mathbf{M}_{1}&space;&plus;&space;b_{12}&space;\mathbf{M}_{2}&space;&plus;&space;b_{13}&space;\mathbf{M}_{3}&space;&plus;&space;b_{14}&space;\mathbf{M}_{4}&space;&plus;&space;b_{15}&space;\mathbf{M}_{5}" title="https://latex.codecogs.com/svg.image?\mathbf{C}_{2,1} = b_{11} \mathbf{M}_{1} + b_{12} \mathbf{M}_{2} + b_{13} \mathbf{M}_{3} + b_{14} \mathbf{M}_{4} + b_{15} \mathbf{M}_{5}" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{C}_{2,2}&space;=&space;b_{16}&space;\mathbf{M}_{1}&space;&plus;&space;b_{17}&space;\mathbf{M}_{2}&space;&plus;&space;b_{18}&space;\mathbf{M}_{3}&space;&plus;&space;b_{19}&space;\mathbf{M}_{4}&space;&plus;&space;b_{20}&space;\mathbf{M}_{5}" title="https://latex.codecogs.com/svg.image?\mathbf{C}_{2,2} = b_{16} \mathbf{M}_{1} + b_{17} \mathbf{M}_{2} + b_{18} \mathbf{M}_{3} + b_{19} \mathbf{M}_{4} + b_{20} \mathbf{M}_{5}" />

를 만족하는 수열 <img src="https://latex.codecogs.com/svg.image?b_n" title="https://latex.codecogs.com/svg.image?b_n" />이 존재한다면 행렬곱의 시간복잡도를 아주 많이 낮출 수 있다.

---



수열 <img src="https://latex.codecogs.com/svg.image?a_n" title="https://latex.codecogs.com/svg.image?a_n" /> 에 대하여 <img src="https://latex.codecogs.com/svg.image?p_n&space;=&space;a_n&space;&plus;&space;1" title="https://latex.codecogs.com/svg.image?p_n = a_n + 1" />이라 하면, 수열 <img src="https://latex.codecogs.com/svg.image?a_n" title="https://latex.codecogs.com/svg.image?a_n" /> 40개의 집합을 <img src="https://latex.codecogs.com/svg.image?p_1p_2p_3\cdots&space;p_{39}p_{40}" title="https://latex.codecogs.com/svg.image?p_1p_2p_3\cdots p_{39}p_{40}" />의 40자리 3진법수라 할 수 있을 것이다.

---

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{1}&space;:=&space;(a_{1}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{2}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{3}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{4}&space;\mathbf{A}_{2,2})&space;(&space;a_{5}\mathbf{B}_{1,1}&space;&plus;&space;a_{6}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{7}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{8}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{1} := (a_{1} \mathbf{A}_{1,1} + a_{2} \mathbf{A}_{1,2} + a_{3} \mathbf{A}_{2,1} + a_{4} \mathbf{A}_{2,2}) ( a_{5}\mathbf{B}_{1,1} + a_{6} \mathbf{B}_{1,2} + a_{7} \mathbf{B}_{2,1} + a_{8} \mathbf{B}_{2,2})" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{2}&space;:=&space;(a_{9}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{10}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{11}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{12}&space;\mathbf{A}_{2,2})&space;(&space;a_{13}\mathbf{B}_{1,1}&space;&plus;&space;a_{14}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{15}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{16}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{2} := (a_{9} \mathbf{A}_{1,1} + a_{10} \mathbf{A}_{1,2} + a_{11} \mathbf{A}_{2,1} + a_{12} \mathbf{A}_{2,2}) ( a_{13}\mathbf{B}_{1,1} + a_{14} \mathbf{B}_{1,2} + a_{15} \mathbf{B}_{2,1} + a_{16} \mathbf{B}_{2,2})" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{3}&space;:=&space;(a_{17}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{18}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{19}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{20}&space;\mathbf{A}_{2,2})&space;(&space;a_{21}\mathbf{B}_{1,1}&space;&plus;&space;a_{22}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{23}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{24}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{3} := (a_{17} \mathbf{A}_{1,1} + a_{18} \mathbf{A}_{1,2} + a_{19} \mathbf{A}_{2,1} + a_{20} \mathbf{A}_{2,2}) ( a_{21}\mathbf{B}_{1,1} + a_{22} \mathbf{B}_{1,2} + a_{23} \mathbf{B}_{2,1} + a_{24} \mathbf{B}_{2,2})" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{4}&space;:=&space;(a_{25}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{26}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{27}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{28}&space;\mathbf{A}_{2,2})&space;(&space;a_{29}\mathbf{B}_{1,1}&space;&plus;&space;a_{30}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{31}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{32}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{4} := (a_{25} \mathbf{A}_{1,1} + a_{26} \mathbf{A}_{1,2} + a_{27} \mathbf{A}_{2,1} + a_{28} \mathbf{A}_{2,2}) ( a_{29}\mathbf{B}_{1,1} + a_{30} \mathbf{B}_{1,2} + a_{31} \mathbf{B}_{2,1} + a_{32} \mathbf{B}_{2,2})" />

<img src="https://latex.codecogs.com/svg.image?\mathbf{M}_{5}&space;:=&space;(a_{33}&space;\mathbf{A}_{1,1}&space;&plus;&space;a_{34}&space;\mathbf{A}_{1,2}&space;&plus;&space;a_{35}&space;\mathbf{A}_{2,1}&space;&plus;&space;a_{36}&space;\mathbf{A}_{2,2})&space;(&space;a_{37}\mathbf{B}_{1,1}&space;&plus;&space;a_{38}&space;\mathbf{B}_{1,2}&space;&plus;&space;a_{39}&space;\mathbf{B}_{2,1}&space;&plus;&space;a_{40}&space;\mathbf{B}_{2,2})" title="https://latex.codecogs.com/svg.image?\mathbf{M}_{5} := (a_{33} \mathbf{A}_{1,1} + a_{34} \mathbf{A}_{1,2} + a_{35} \mathbf{A}_{2,1} + a_{36} \mathbf{A}_{2,2}) ( a_{37}\mathbf{B}_{1,1} + a_{38} \mathbf{B}_{1,2} + a_{39} \mathbf{B}_{2,1} + a_{40} \mathbf{B}_{2,2})" />

에서, 이 식을 잘 들여다보면,

<img src="https://latex.codecogs.com/svg.image?a_1=a_9=a_{17}=a_{25}=a_{33}=0" title="https://latex.codecogs.com/svg.image?a_1=a_9=a_{17}=a_{25}=a_{33}=0" />이면 최종 원소에서 무조건 <img src="https://latex.codecogs.com/svg.image?\mathbf{A}_{1,1}" title="https://latex.codecogs.com/svg.image?\mathbf{A}_{1,1}" />이 빠지게 되므로, 애초에 계산에서 제외할 수 있다.

마찬가지로,

<img src="https://latex.codecogs.com/svg.image?a_2=a_{10}=a_{18}=a_{26}=a_{34}=0" title="https://latex.codecogs.com/svg.image?a_2=a_{10}=a_{18}=a_{26}=a_{34}=0" />인 경우,

<img src="https://latex.codecogs.com/svg.image?a_3=a_{11}=a_{19}=a_{27}=a_{35}=0" title="https://latex.codecogs.com/svg.image?a_3=a_{11}=a_{19}=a_{27}=a_{35}=0" />인 경우,

<img src="https://latex.codecogs.com/svg.image?a_4=a_{12}=a_{20}=a_{28}=a_{36}=0" title="https://latex.codecogs.com/svg.image?a_4=a_{12}=a_{20}=a_{28}=a_{36}=0" />인 경우,

<img src="https://latex.codecogs.com/svg.image?a_5=a_{13}=a_{21}=a_{29}=a_{37}=0" title="https://latex.codecogs.com/svg.image?a_5=a_{13}=a_{21}=a_{29}=a_{37}=0" />인 경우,

<img src="https://latex.codecogs.com/svg.image?a_6=a_{14}=a_{22}=a_{30}=a_{38}=0" title="https://latex.codecogs.com/svg.image?a_6=a_{14}=a_{22}=a_{30}=a_{38}=0" />인 경우,

<img src="https://latex.codecogs.com/svg.image?a_7=a_{15}=a_{23}=a_{31}=a_{39}=0" title="https://latex.codecogs.com/svg.image?a_7=a_{15}=a_{23}=a_{31}=a_{39}=0" />인 경우,

<img src="https://latex.codecogs.com/svg.image?a_8=a_{16}=a_{24}=a_{32}=a_{40}=0" title="https://latex.codecogs.com/svg.image?a_8=a_{16}=a_{24}=a_{32}=a_{40}=0" />인 경우를 "모두" 제외할 수 있다.

---

비슷한 예로, 최종단계에서 <img src="https://latex.codecogs.com/svg.image?\mathbf&space;A_{1,&space;1}&space;\mathbf&space;B_{1,&space;1}" title="https://latex.codecogs.com/svg.image?\mathbf A_{1, 1} \mathbf B_{1, 1}" />가 있어야 하므로

<img src="https://latex.codecogs.com/svg.image?a_1" title="https://latex.codecogs.com/svg.image?a_1" />, <img src="https://latex.codecogs.com/svg.image?a_5" title="https://latex.codecogs.com/svg.image?a_5" /> 중에서 하나라도 0이 있거나,

<img src="https://latex.codecogs.com/svg.image?a_9" title="https://latex.codecogs.com/svg.image?a_9" />, <img src="https://latex.codecogs.com/svg.image?a_{13}" title="https://latex.codecogs.com/svg.image?a_{13}" /> 중에서 하나라도 0이 있거나 ...(중략)

<img src="https://latex.codecogs.com/svg.image?a_{33}" title="https://latex.codecogs.com/svg.image?a_{33}" />, <img src="https://latex.codecogs.com/svg.image?a_{37}" title="https://latex.codecogs.com/svg.image?a_{37}" /> 중에서 하나라도 0이 있는 경우를 제외할 수 있고, 마찬가지로 여덟가지의 경우를 제외힐 수 있다. (최종 단계에서 여덟개의 행렬곱 세트가 필요하므로)
